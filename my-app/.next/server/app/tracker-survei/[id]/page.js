(()=>{var a={};a.id=116,a.ids=[116],a.modules={2934:a=>{"use strict";a.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:a=>{"use strict";a.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:a=>{"use strict";a.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5315:a=>{"use strict";a.exports=require("path")},7360:a=>{"use strict";a.exports=require("url")},4198:a=>{a.exports={style:{fontFamily:"'__Caudex_ebaa45', '__Caudex_Fallback_ebaa45'",fontWeight:700,fontStyle:"normal"},className:"__className_ebaa45"}},4099:(a,e,t)=>{"use strict";t.r(e),t.d(e,{GlobalError:()=>r.a,__next_app__:()=>_,originalPathname:()=>p,pages:()=>d,routeModule:()=>m,tree:()=>o}),t(207),t(6765),t(996);var s=t(170),i=t(5002),n=t(3876),r=t.n(n),l=t(6299),u={};for(let a in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(a)&&(u[a]=()=>l[a]);t.d(e,u);let o=["",{children:["tracker-survei",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,207)),"C:\\Users\\kayli\\OneDrive\\Documents\\09\\propen\\siap-fe\\my-app\\src\\app\\tracker-survei\\[id]\\page.js"]}]},{}]},{metadata:{icon:[async a=>(await Promise.resolve().then(t.bind(t,3881))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,6765)),"C:\\Users\\kayli\\OneDrive\\Documents\\09\\propen\\siap-fe\\my-app\\src\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async a=>(await Promise.resolve().then(t.bind(t,3881))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["C:\\Users\\kayli\\OneDrive\\Documents\\09\\propen\\siap-fe\\my-app\\src\\app\\tracker-survei\\[id]\\page.js"],p="/tracker-survei/[id]/page",_={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/tracker-survei/[id]/page",pathname:"/tracker-survei/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},6540:(a,e,t)=>{Promise.resolve().then(t.bind(t,2884))},2884:(a,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>d});var s=t(7247),i=t(4198),n=t.n(i),r=t(8964),l=t(571);t(5996);var u=t(4178);let o=({label:a,status:e,onStatusChange:t,fieldKey:i,isLoading:n,isEditable:r,className:u=""})=>(0,s.jsxs)("div",{className:`w-full text-xs mb-2 ${u}`,children:[s.jsx("div",{className:"text-xs font-medium mb-1",title:a,children:a}),s.jsx("div",{className:`border rounded-md p-2 ${{NOT_STARTED:"bg-gray-200",IN_PROGRESS:"bg-yellow-200",FINISHED:"bg-green-200",DELAYED:"bg-red-200"}[e]} ${n?"opacity-50":""}`,children:s.jsx("select",{value:e,onChange:a=>{let e=a.target.value;r?t(i,e):l.Am.error("You don't have permission to update this status")},disabled:n||!r,className:`w-full bg-transparent border-none focus:ring-0 ${r?"cursor-pointer":"cursor-not-allowed"} text-xs`,"aria-label":`Update status for ${a}`,children:Object.entries({NOT_STARTED:"Not Started",IN_PROGRESS:"In Progress",FINISHED:"Finished",DELAYED:"Delayed"}).map(([a,e])=>s.jsx("option",{value:a,children:e},a))})})]});function d({params:a}){let{id:e}=a;(0,u.useRouter)();let[t,i]=(0,r.useState)(null),[d,p]=(0,r.useState)(!0),[_,m]=(0,r.useState)(null),[c,b]=(0,r.useState)(null),g=async()=>{let a=localStorage.getItem("authToken");try{let t=await fetch(`https://siap-be-production.up.railway.app/api/survei-status/${e}/`,{headers:{Authorization:`Token ${a}`}});if(!t.ok)throw Error("Failed to fetch survey data");let s=await t.json(),n=s.status.reduce((a,e)=>{let[t,s]=Object.entries(e)[0];return a[t]=s,a},{});i({...s,status:n})}catch(a){l.Am.error("Failed to load survey data. Please try again.")}finally{p(!1)}},v=async(a,t)=>{let s;let n=localStorage.getItem("authToken");m(a),["buat_kontrak","buat_invoice_dp","pembayaran_dp","pembuatan_kwitansi_dp"].includes(a)?s=`https://siap-be-production.up.railway.app/api/survei-status/${e}/administrasi-awal/`:["terima_request_souvenir","ambil_souvenir"].includes(a)?s=`https://siap-be-production.up.railway.app/api/survei-status/${e}/logistik/`:["terima_info_survei","lakukan_survei","pantau_responden","pantau_data_cleaning"].includes(a)?s=`https://siap-be-production.up.railway.app/api/survei-status/${e}/pengendali-mutu/`:["pembuatan_laporan","buat_invoice_final","pembayaran_lunas","pembuatan_kwitansi_final","penyerahan_laporan"].includes(a)&&(s=`https://siap-be-production.up.railway.app/api/survei-status/${e}/administrasi-akhir/`);try{let e=await fetch(s,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Token ${n}`},body:JSON.stringify({[a]:t})});if(!e.ok){let a=await e.json(),t=a.__all__?.[0]||"Failed to update status";throw Error(t)}i(e=>({...e,status:{...e.status,[a]:t}})),l.Am.success("Status updated successfully")}catch(a){l.Am.error(a.message||"Failed to update status. Please try again."),g()}finally{m(null)}},h=a=>({Administrasi:["buat_kontrak","buat_invoice_dp","pembayaran_dp","pembuatan_kwitansi_dp","pembuatan_laporan","buat_invoice_final","pembayaran_lunas","pembuatan_kwitansi_final","penyerahan_laporan"],Logistik:["terima_request_souvenir","ambil_souvenir"],"Pengendali Mutu":["terima_info_survei","lakukan_survei","pantau_responden","pantau_data_cleaning"],Eksekutif:[]})[c]?.includes(a)||!1;return d||!t?s.jsx("div",{className:"p-6 max-w-7xl mx-auto",children:(0,s.jsxs)("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-20 bg-gray-200 rounded-lg mb-6"}),s.jsx("div",{className:"space-y-8",children:[1,2,3,4].map(a=>s.jsx("div",{className:"h-48 bg-gray-200 rounded-lg"},a))})]})}):(0,s.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"border-b border-gray-300 pb-4 mb-6",children:[s.jsx("h2",{className:`text-4xl font-bold mb-6 text-primary-900 ${n().className}`,children:"Tracker Status"}),s.jsx("div",{className:`mt-2 text-lg ${n().className}`,children:t.nama_survei}),s.jsx("div",{className:`text-gray-600 ${n().className}`,children:t.nama_klien})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"font-semibold text-lg mb-4",children:"Administrasi Awal"}),s.jsx(o,{label:"Buat Kontrak",status:t.status.buat_kontrak,onStatusChange:v,fieldKey:"buat_kontrak",isLoading:"buat_kontrak"===_,isEditable:h("buat_kontrak")}),s.jsx(o,{label:"Buat Invoice DP",status:t.status.buat_invoice_dp,onStatusChange:v,fieldKey:"buat_invoice_dp",isLoading:"buat_invoice_dp"===_,isEditable:h("buat_invoice_dp")}),s.jsx(o,{label:"Pembayaran DP",status:t.status.pembayaran_dp,onStatusChange:v,fieldKey:"pembayaran_dp",isLoading:"pembayaran_dp"===_,isEditable:h("pembayaran_dp")}),s.jsx(o,{label:"Pembuatan Kwitansi DP",status:t.status.pembuatan_kwitansi_dp,onStatusChange:v,fieldKey:"pembuatan_kwitansi_dp",isLoading:"pembuatan_kwitansi_dp"===_,isEditable:h("pembuatan_kwitansi_dp")})]}),(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"font-semibold text-lg mb-4",children:"Logistik"}),s.jsx(o,{label:"Menerima request souvenir",status:t.status.terima_request_souvenir,onStatusChange:v,fieldKey:"terima_request_souvenir",isLoading:"terima_request_souvenir"===_,isEditable:h("terima_request_souvenir")}),s.jsx(o,{label:"Mengambil souvenir",status:t.status.ambil_souvenir,onStatusChange:v,fieldKey:"ambil_souvenir",isLoading:"ambil_souvenir"===_,isEditable:h("ambil_souvenir")})]}),(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"font-semibold text-lg mb-4",children:"Pengendali Mutu"}),s.jsx(o,{label:"Menerima informasi survei",status:t.status.terima_info_survei,onStatusChange:v,fieldKey:"terima_info_survei",isLoading:"terima_info_survei"===_,isEditable:h("terima_info_survei")}),s.jsx(o,{label:"Melakukan survei",status:t.status.lakukan_survei,onStatusChange:v,fieldKey:"lakukan_survei",isLoading:"lakukan_survei"===_,isEditable:h("lakukan_survei")}),s.jsx(o,{label:"Memantau responden",status:t.status.pantau_responden,onStatusChange:v,fieldKey:"pantau_responden",isLoading:"pantau_responden"===_,isEditable:h("pantau_responden")}),s.jsx(o,{label:"Memantau data cleaning",status:t.status.pantau_data_cleaning,onStatusChange:v,fieldKey:"pantau_data_cleaning",isLoading:"pantau_data_cleaning"===_,isEditable:h("pantau_data_cleaning")})]}),(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"font-semibold text-lg mb-4",children:"Administrasi Akhir"}),s.jsx(o,{label:"Pembuatan Laporan",status:t.status.pembuatan_laporan,onStatusChange:v,fieldKey:"pembuatan_laporan",isLoading:"pembuatan_laporan"===_,isEditable:h("pembuatan_laporan")}),s.jsx(o,{label:"Buat Invoice Final",status:t.status.buat_invoice_final,onStatusChange:v,fieldKey:"buat_invoice_final",isLoading:"buat_invoice_final"===_,isEditable:h("buat_invoice_final")}),s.jsx(o,{label:"Pembayaran Lunas",status:t.status.pembayaran_lunas,onStatusChange:v,fieldKey:"pembayaran_lunas",isLoading:"pembayaran_lunas"===_,isEditable:h("pembayaran_lunas")}),s.jsx(o,{label:"Pembuatan Kwitansi Final",status:t.status.pembuatan_kwitansi_final,onStatusChange:v,fieldKey:"pembuatan_kwitansi_final",isLoading:"pembuatan_kwitansi_final"===_,isEditable:h("pembuatan_kwitansi_final")}),s.jsx(o,{label:"Penyerahan Laporan",status:t.status.penyerahan_laporan,onStatusChange:v,fieldKey:"penyerahan_laporan",isLoading:"penyerahan_laporan"===_,isEditable:h("penyerahan_laporan")})]})]})]})}},207:(a,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>s});let s=(0,t(5347).createProxy)(String.raw`C:\Users\kayli\OneDrive\Documents\09\propen\siap-fe\my-app\src\app\tracker-survei\[id]\page.js#default`)},3881:(a,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>i});var s=t(4564);let i=a=>[{type:"image/x-icon",sizes:"29x32",url:(0,s.fillMetadataSegment)(".",a.params,"favicon.ico")+""}]}};var e=require("../../../webpack-runtime.js");e.C(a);var t=a=>e(e.s=a),s=e.X(0,[379,354,564,384],()=>t(4099));module.exports=s})();