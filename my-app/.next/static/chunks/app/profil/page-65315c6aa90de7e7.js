(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6099],{3439:function(e,a,t){Promise.resolve().then(t.bind(t,680))},9376:function(e,a,t){"use strict";var s=t(5475);t.o(s,"useParams")&&t.d(a,{useParams:function(){return s.useParams}}),t.o(s,"usePathname")&&t.d(a,{usePathname:function(){return s.usePathname}}),t.o(s,"useRouter")&&t.d(a,{useRouter:function(){return s.useRouter}})},680:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return r}});var s=t(7437),i=t(753),n=t.n(i),o=t(2265),l=t(9376);function r(){let e=(0,l.useRouter)(),[a,t]=(0,o.useState)(!1),[i,r]=(0,o.useState)(!1),[c,d]=(0,o.useState)(!1),[u,p]=(0,o.useState)(""),[m,h]=(0,o.useState)(""),[f,_]=(0,o.useState)(""),[x,g]=(0,o.useState)(""),[j,b]=(0,o.useState)(""),[w,v]=(0,o.useState)(null),[N,y]=(0,o.useState)(!1),[k,S]=(0,o.useState)(!1),[C,E]=(0,o.useState)(""),[P,T]=(0,o.useState)(""),[B,F]=(0,o.useState)("");(0,o.useEffect)(()=>{(async()=>{let a=localStorage.getItem("authToken");if(!a){e.push("/login");return}try{let e=await fetch("".concat("https://siap-be-production.up.railway.app/api/","profil/"),{method:"GET",headers:{Authorization:"Token ".concat(a),"Content-Type":"application/json"}});if(!e.ok)throw Error("Failed to fetch profile");let t=await e.json();p(t.email),h(t.first_name),_(t.last_name),b(t.username),g("".concat(t.first_name||""," ").concat(t.last_name||"").trim()),F(t.role)}catch(e){v("Unable to fetch user data")}})()},[e]);let G=async e=>{e.preventDefault();let a=x.split(" "),t=a[0]||"",s=a.slice(1).join(" ")||"",i=localStorage.getItem("authToken");try{if(!(await fetch("".concat("https://siap-be-production.up.railway.app/api/","profil/"),{method:"PATCH",headers:{Authorization:"Token ".concat(i),"Content-Type":"application/json"},body:JSON.stringify({first_name:t,last_name:s,email:u,username:j})})).ok)throw Error("Failed to update profile");if(C&&P){let e=await fetch("".concat("https://siap-be-production.up.railway.app/api/","change-password/"),{method:"PATCH",headers:{Authorization:"Token ".concat(i),"Content-Type":"application/json"},body:JSON.stringify({old_password:C,new_password:P})});if(!e.ok){let a=await e.json();throw Error(a.error||"Failed to update password")}alert("Password changed successfully")}else alert("Profile updated successfully")}catch(e){alert(e.message)}};return w?(0,s.jsxs)("div",{children:["Error: ",w]}):(0,s.jsxs)("div",{className:n().containerbackground,children:[(0,s.jsx)("div",{className:n().container,children:(0,s.jsxs)("div",{className:n().content,children:[(0,s.jsxs)("h1",{className:n().title,children:["Profil ",m]}),(0,s.jsx)("h2",{className:n().roleHeader,children:B}),(0,s.jsxs)("form",{className:n().form,onSubmit:G,children:[(0,s.jsxs)("div",{className:n().fieldGroup,children:[(0,s.jsx)("label",{children:"Email"}),(0,s.jsx)("input",{type:"email",value:u,onChange:e=>p(e.target.value),disabled:!a,className:a?"":n().disabledInput}),(0,s.jsx)("span",{className:n().icon,onClick:()=>t(!a),children:(0,s.jsx)("img",{src:"/images/Edit.svg",alt:"Edit"})})]}),(0,s.jsxs)("div",{className:n().fieldGroup,children:[(0,s.jsx)("label",{children:"Nama"}),(0,s.jsx)("input",{type:"text",value:x,onChange:e=>g(e.target.value),disabled:!i,className:i?"":n().disabledInput}),(0,s.jsx)("span",{className:n().icon,onClick:()=>r(!i),children:(0,s.jsx)("img",{src:"/images/Edit.svg",alt:"Edit"})})]}),(0,s.jsxs)("div",{className:n().fieldGroup,children:[(0,s.jsx)("label",{children:"Username"}),(0,s.jsx)("input",{type:"text",value:j,onChange:e=>b(e.target.value),disabled:!c,className:c?"":n().disabledInput}),(0,s.jsx)("span",{className:n().icon,onClick:()=>d(!c),children:(0,s.jsx)("img",{src:"/images/Edit.svg",alt:"Edit"})})]}),(0,s.jsxs)("div",{className:n().passwordFields,children:[(0,s.jsxs)("div",{className:n().fieldGroup,children:[(0,s.jsx)("label",{children:"Password Lama"}),(0,s.jsx)("input",{type:N?"text":"password",value:C,onChange:e=>E(e.target.value),placeholder:"********"}),(0,s.jsx)("span",{className:n().icon,onClick:()=>y(!N),children:(0,s.jsx)("img",{src:"/images/eye-icon.png",alt:"Toggle Password Visibility"})})]}),(0,s.jsxs)("div",{className:n().fieldGroup,children:[(0,s.jsx)("label",{children:"Password Baru"}),(0,s.jsx)("input",{type:k?"text":"password",value:P,onChange:e=>T(e.target.value),placeholder:"********"}),(0,s.jsx)("span",{className:n().icon,onClick:()=>S(!k),children:(0,s.jsx)("img",{src:"/images/eye-icon.png",alt:"Toggle New Password Visibility"})})]})]}),(0,s.jsxs)("div",{className:n().buttons,children:[(0,s.jsx)("button",{type:"submit",className:n().saveButton,children:"Simpan"}),(0,s.jsx)("button",{type:"button",className:n().cancelButton,onClick:()=>e.push("/dashboard"),children:"Batal"})]})]})]})}),(0,s.jsx)("div",{className:n().footer,children:"@2024 optimasys | Contact optimasys.work@gmail.com"})]})}},753:function(e){e.exports={containerbackground:"profil_containerbackground__sxNM4",container:"profil_container__Vn0XF",roleHeader:"profil_roleHeader__O8wB2",content:"profil_content__QkUzx",title:"profil_title__V1XF6",form:"profil_form__kDa7l",fieldGroup:"profil_fieldGroup__wC5nk",icon:"profil_icon__Sx7aP",disabledInput:"profil_disabledInput__00Y1S",passwordFields:"profil_passwordFields___udEH",buttons:"profil_buttons__1hyC_",saveButton:"profil_saveButton__JV7pd",cancelButton:"profil_cancelButton__wr9TD",footer:"profil_footer__WctUp"}}},function(e){e.O(0,[8560,2971,2117,1744],function(){return e(e.s=3439)}),_N_E=e.O()}]);