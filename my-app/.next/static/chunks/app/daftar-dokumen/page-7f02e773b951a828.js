(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1534],{3546:function(e,t,a){Promise.resolve().then(a.bind(a,3248))},3248:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return l}});var n=a(7437),o=a(2265),i=a(9376);a(7409);var r=a(349),s=a.n(r);function l(){let e=(0,i.useRouter)(),[t,a]=(0,o.useState)(""),[r,l]=(0,o.useState)(1),[c,d]=(0,o.useState)([]),[u,m]=(0,o.useState)(null),[h,_]=(0,o.useState)(!1),[p,f]=(0,o.useState)(null),[k,x]=(0,o.useState)("desc"),[j,y]=(0,o.useState)("id"),[C,v]=(0,o.useState)("");(0,o.useEffect)(()=>{let a=async()=>{let t=localStorage.getItem("authToken");if(!t){e.push("/login");return}try{let a=await fetch("".concat("https://siap-be-production.up.railway.app/api/","accounts/check_role_proposal/"),{headers:{Authorization:"Token ".concat(t)}}),n=await a.json();(n.error||"Administrasi"!==n.role&&"Eksekutif"!==n.role)&&e.push("/login")}catch(t){console.error("Failed to verify role:",t),e.push("/login")}};(async()=>{try{let e=t?"".concat("https://siap-be-production.up.railway.app/api/","daftarDokumen/searchDokumen/?q=").concat(encodeURIComponent(t)):"".concat("https://siap-be-production.up.railway.app/api/","daftarDokumen/daftarDokumen/"),a=await fetch(e),n=await a.json();console.log("Fetched documents:",n);let o=n.sort((e,t)=>t.id.localeCompare(e.id));d(o)}catch(e){console.error("Error fetching documents:",e)}})(),a()},[t],[e]);let g=e=>{f(e),_(!0)},w=c.filter(e=>{let a=e.survey_name.toLowerCase().includes(t.toLowerCase())||e.client_name.toLowerCase().includes(t.toLowerCase())||e.doc_type.toLowerCase().includes(t.toLowerCase())||e.id.toLowerCase().includes(t.toLowerCase()),n=!C||e.doc_type.toLowerCase()===C.toLowerCase();return a&&n}),N=e=>{let t="asc"===k?"desc":"asc";y(e),x(t),d([...c].sort((a,n)=>{let o,i;return("id"===e?(o=parseInt(a.id.slice(0,3)),i=parseInt(n.id.slice(0,3))):(o=a[e].toLowerCase(),i=n[e].toLowerCase()),o<i)?"asc"===t?-1:1:o>i?"asc"===t?1:-1:0}))},b=10*r,D=b-10,B=w.slice(D,b),S=Math.ceil(w.length/10),L=(t,a)=>{let n=encodeURIComponent(t);e.push("/daftar-dokumen/detail-dokumen/".concat(n,"/").concat(a))},O=async(e,t)=>{let a=e+D,n=encodeURIComponent(t);m(a);try{await fetch("".concat("https://siap-be-production.up.railway.app/api/","daftarDokumen/").concat(n,"/delete/"),{method:"DELETE"}),_(!1),console.log("dokumen deleted");let e=c.filter((e,t)=>t!==a);d(e)}catch(e){console.error("Error deleting dokumen:",e)}finally{m(null)}};return(0,n.jsxs)("div",{className:s().mainContainer,children:[(0,n.jsxs)("div",{className:s().container,children:[(0,n.jsx)("h1",{className:"text-4xl font-weight-700 text-primary-900",children:"Daftar Dokumen Pendukung"}),(0,n.jsx)("div",{className:"w-full flex px-6 py-3 mb-6 rounded-full border-2 border overflow-hidden mx-auto",children:(0,n.jsx)("input",{type:"text",placeholder:"Cari dokumen...",value:t,onChange:e=>{a(e.target.value),l(1)},className:"w-full outline-none bg-transparent text-gray-600 text-sm"})}),(0,n.jsx)("div",{className:s().filterContainer,children:(0,n.jsxs)("select",{value:C,onChange:e=>v(e.target.value),className:s().filterSelect,children:[(0,n.jsx)("option",{value:"",children:"Filter Jenis Dokumen"}),(0,n.jsx)("option",{value:"invoiceDP",children:"Invoice DP"}),(0,n.jsx)("option",{value:"invoiceFinal",children:"Invoice Final"}),(0,n.jsx)("option",{value:"kwitansiDP",children:"Kwitansi DP"}),(0,n.jsx)("option",{value:"kwitansiFinal",children:"Kwitansi Final"})]})}),(0,n.jsxs)("table",{className:s().table,children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:s().header,children:[(0,n.jsxs)("th",{onClick:()=>N("id"),children:["Kode ","id"===j?"asc"===k?"↑":"↓":""]}),(0,n.jsx)("th",{children:"Judul"}),(0,n.jsx)("th",{children:"Klien"}),(0,n.jsx)("th",{children:"Jenis Dokumen"}),(0,n.jsx)("th",{children:"Action"})]})}),(0,n.jsx)("tbody",{children:B.map((e,t)=>(0,n.jsxs)("tr",{className:t+D===u?s().fadeOut:"",children:[(0,n.jsx)("td",{children:e.id}),(0,n.jsx)("td",{children:e.survey_name}),(0,n.jsx)("td",{children:e.client_name}),(0,n.jsx)("td",{children:e.doc_type}),(0,n.jsxs)("td",{className:s().actions,children:[(0,n.jsx)("button",{onClick:()=>L(e.id,e.doc_type),className:"text-gray-800 hover:text-gray-600 transition-colors",children:(0,n.jsx)("img",{src:"/images/eye-icon.png",alt:"Details"})}),(0,n.jsx)("button",{className:s().deleteButton,onClick:()=>g(t),children:(0,n.jsx)("img",{src:"/images/Delete.svg",alt:"Delete"})})]})]},e.id))})]}),(0,n.jsxs)("div",{className:s().pagination,children:[r>1&&(0,n.jsx)("button",{onClick:()=>l(r-1),children:"< Kembali"}),r<S&&(0,n.jsx)("button",{onClick:()=>l(r+1),children:"Selanjutnya >"})]})]}),h&&(0,n.jsx)("div",{className:s().modalOverlay,children:(0,n.jsxs)("div",{className:s().modal,children:[(0,n.jsx)("p",{children:"Apakah Anda yakin ingin menghapus dokumen ini?"}),(0,n.jsx)("button",{onClick:()=>O(p,c[p].id),className:s().confirmButton,children:"Ya"}),(0,n.jsx)("button",{onClick:()=>_(!1),className:s().cancelButton,children:"Tidak"})]})})]})}},349:function(e){e.exports={container:"daftar-dokumen_container__0CDR6",title:"daftar-dokumen_title__CiV18",addButton:"daftar-dokumen_addButton__p7UNh",searchContainer:"daftar-dokumen_searchContainer__hJz2t",searchInput:"daftar-dokumen_searchInput__zGNqX",modalOverlay:"daftar-dokumen_modalOverlay__M6I7O",modal:"daftar-dokumen_modal__QkeWy",confirmButton:"daftar-dokumen_confirmButton__Oux4N",cancelButton:"daftar-dokumen_cancelButton__c2Gzi",table:"daftar-dokumen_table__2QVCr",header:"daftar-dokumen_header__W5nBy",icon:"daftar-dokumen_icon__OvP8b",actions:"daftar-dokumen_actions__KWaUN",editButton:"daftar-dokumen_editButton__yg_Zz",deleteButton:"daftar-dokumen_deleteButton__n_J3a",moreButton:"daftar-dokumen_moreButton__S2M7c",pagination:"daftar-dokumen_pagination__U3K1y",fadeOut:"daftar-dokumen_fadeOut__Sxu65",fadeOutSlideUp:"daftar-dokumen_fadeOutSlideUp__RrEEm"}}},function(e){e.O(0,[2055,8304,2971,2117,1744],function(){return e(e.s=3546)}),_N_E=e.O()}]);